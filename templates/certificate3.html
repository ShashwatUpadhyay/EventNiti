{% extends "index.html" %}

{% block title %}
{{certi_obj.event.title}} Certificate
{% endblock title %}

{% block content %}
<div class="bg-gradient-to-br pt-[150px] from-blue-50 to-indigo-100 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header with event branding -->
        <div class="text-center mb-12 animate-fade-in">
            <div class="inline-flex items-center justify-center mb-4">
                <h1 class="text-3xl font-bold text-indigo-800">{{ certi_obj.event.title }}</h1>
            </div>
            <p class="text-lg text-indigo-600 max-w-3xl mx-auto">
                Celebrating excellence and achievement in our community
            </p>
        </div>

        <!-- Certificate Container -->
        <div id="certificate" class="relative bg-white rounded-2xl overflow-hidden shadow-2xl max-w-4xl mx-auto border-8 border-white transform transition-all duration-500 hover:scale-[1.01] hover:shadow-2xl">
            <!-- Decorative elements -->
            <div class="absolute inset-0 overflow-hidden">
                <div class="absolute top-0 left-0 w-32 h-32 bg-indigo-100 opacity-20 rounded-full -ml-16 -mt-16 animate-float-slow"></div>
                <div class="absolute bottom-0 right-0 w-40 h-40 bg-blue-100 opacity-20 rounded-full -mr-20 -mb-20 animate-float"></div>
                <div class="absolute top-1/4 right-1/4 w-24 h-24 bg-indigo-100 opacity-15 rounded-full animate-float-reverse"></div>
            </div>
            
            <!-- Gold foil effect border -->
            <div class="absolute inset-0 border-8 border-transparent pointer-events-none" style="box-shadow: inset 0 0 30px rgba(212, 175, 55, 0.3);"></div>
            
            <!-- Certificate content -->
            <div class="relative z-10 p-8 sm:p-12">
                <!-- QR Code - Top right -->
                <div class="absolute top-6 right-6 bg-white p-2 rounded-lg shadow-md hover:scale-110 transition-transform">
                    <img src="data:image/png;base64,{{qr_code_base64}}" alt="Verification QR Code" class="w-20 h-20">
                    <p class="text-xs text-center mt-1 text-gray-600">Scan to verify</p>
                </div>
                
                <!-- Certificate header -->
                <div class="text-center mb-12">
                    <div class="inline-block mb-6">
                        <svg class="w-16 h-16 text-indigo-600 animate-bounce-slow" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-blue-600 mb-4">
                        Certificate of Achievement
                    </h2>
                    <div class="w-32 h-1 bg-gradient-to-r from-blue-400 to-indigo-500 mx-auto mb-6"></div>
                    <p class="text-gray-600 italic">
                        This certificate is proudly presented by {{ certi_obj.event.title }}
                    </p>
                </div>
                
                <!-- Main content -->
                <div class="mb-16 text-center">
                    <p class="text-lg text-gray-700 mb-8">
                        This is to certify that
                    </p>
                    
                    <div class="mb-10">
                        <h3 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-2 animate-text-glow">
                            {{ certi_obj.user.first_name }} {{ certi_obj.user.last_name }}
                        </h3>
                        <div class="w-48 h-0.5 bg-gradient-to-r from-blue-200 to-indigo-200 mx-auto my-4"></div>
                        <p class="text-gray-700">
                            has successfully completed all requirements and demonstrated excellence in
                        </p>
                    </div>
                    
                    <div class="inline-block px-6 py-3 bg-indigo-50 rounded-lg border border-indigo-100 mb-8">
                        <h4 class="text-xl font-semibold text-indigo-700">
                            {{ certi_obj.event.title }}
                        </h4>
                        <p class="text-sm text-indigo-600 mt-1">
                            {{ certi_obj.issue_date|date:"F j, Y" }}
                        </p>
                    </div>
                    
                    <p class="text-gray-700 max-w-2xl mx-auto">
                        This achievement recognizes dedication, skill, and commitment to professional growth in the field of event participation.
                    </p>
                </div>
                
                <!-- Signatures and seals -->
                <div class="flex flex-col sm:flex-row justify-between items-center">
                    <!-- Signature Section (hidden from users but appears in PDF) -->
                    <div class="mb-6 sm:mb-0">
                        <!-- Visible placeholder for users -->
                 
                        
                        <!-- Actual signature (hidden on screen but appears in print/PDF) -->
                        <div class="">
                                <img src="https://img.freepik.com/premium-vector/abstract-universal-fake-signature-documents-contracts-isolated-white-background_608189-1147.jpg?w=740" alt="Director Signature" class="h-16 w-40 object-contain">
                                <hr class="border-t-2 border-blue-300 my-2">
                                Hemant Singh(Head of Department)
                                <div class="h-20 w-40  relative">
                                    <p class="absolute bottom-0 left-0 text-sm text-gray-600">Authorized Signature</p>
                                </div>
                        </div>
                        
                        <p class="text-sm font-medium text-gray-700 mt-2">
                            Event Director
                        </p>
                    </div>
                    
                    <!-- Official Seal (unchanged) -->
                    <div class="relative">
                        <div class="h-24 w-24 bg-indigo-100 rounded-full flex items-center justify-center opacity-90">
                            <svg class="w-12 h-12 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                            </svg>
                        </div>
                        <p class="text-xs text-center mt-2 text-gray-600">Official Seal</p>
                    </div>
                    
                    <!-- Verification Code (unchanged) -->
                    <div class="mt-6 sm:mt-0">
                        <img src="https://img.freepik.com/premium-vector/abstract-universal-fake-signature-documents-contracts-isolated-white-background_608189-1147.jpg?w=740" alt="Director Signature" class="h-16 w-40 object-contain">
                        <hr class="border-t-2 border-blue-300 my-2">

                        Hemant Singh(Head of Department)
                        <div class="h-20 w-40 relative">
                            <p class="absolute bottom-0 right-0 text-sm text-gray-600">Verification Code</p>
                        </div>
                        <p class="text-xs text-blue-600 text-right mt-2 break-all">
                            {{ certi_obj.hash }}
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Action buttons -->
        <div class="flex flex-col sm:flex-row justify-center gap-4 mt-12 animate-fade-in-up">
            <button id="download-btn" class="flex items-center justify-center px-8 py-3 bg-gradient-to-r from-indigo-600 to-blue-600 text-white font-medium rounded-lg shadow-md hover:shadow-lg transform transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                Download Certificate
            </button>
            
            <a href="{{ linkedin_url }}" target="_blank" class="flex items-center justify-center px-8 py-3 bg-gradient-to-r from-blue-700 to-blue-500 text-white font-medium rounded-lg shadow-md hover:shadow-lg transform transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
                Share on LinkedIn
            </a>
            
            <button onclick="window.print()" class="flex items-center justify-center px-8 py-3 bg-white border border-gray-300 text-gray-700 font-medium rounded-lg shadow-sm hover:shadow-md transform transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                </svg>
                Print Certificate
            </button>
        </div>
        
        <!-- Verification note -->
        <div class="text-center mt-12 text-gray-600 text-sm animate-fade-in">
            <p>This certificate can be verified at <a href="{% url 'certificate' certi_obj.hash %}" class="text-blue-600 hover:underline">certverify.example.com/{{ certi_obj.hash }}</a></p>
        </div>
    </div>
</div>

<!-- Custom animations -->
<style>
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }
    @keyframes floatSlow {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
    }
    @keyframes floatReverse {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(8px); }
    }
    @keyframes bounceSlow {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-8px); }
    }
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes textGlow {
        0% { text-shadow: 0 0 5px rgba(79, 70, 229, 0.3); }
        50% { text-shadow: 0 0 15px rgba(79, 70, 229, 0.5); }
        100% { text-shadow: 0 0 5px rgba(79, 70, 229, 0.3); }
    }
    .animate-fade-in { animation: fadeIn 1s ease-in; }
    .animate-float { animation: float 6s ease-in-out infinite; }
    .animate-float-slow { animation: float 8s ease-in-out infinite; }
    .animate-float-reverse { animation: floatReverse 7s ease-in-out infinite; }
    .animate-bounce-slow { animation: bounceSlow 3s ease-in-out infinite; }
    .animate-fade-in-up { animation: fadeInUp 0.8s ease-out; }
    .animate-text-glow { animation: textGlow 3s ease-in-out infinite; }
</style>

<script>
    document.getElementById("download-btn").addEventListener("click", () => {
        // Disable animations before capturing
        const certificate = document.getElementById("certificate");
        certificate.classList.remove('hover:scale-[1.01]', 'hover:shadow-2xl');
        
        // Remove all animation classes
        const animatedElements = certificate.querySelectorAll('[class*="animate-"]');
        animatedElements.forEach(el => {
            el.classList.remove(...Array.from(el.classList).filter(c => c.startsWith('animate-')));
        });
        
        // Generate PDF
        const opt = {
            margin: 0.5,
            filename: '{{ certi_obj.user.first_name }}_{{ certi_obj.user.last_name }}_Certificate.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { 
                scale: 2,
                scrollX: 0,
                scrollY: 0,
                useCORS: true,
                allowTaint: true
            },
            jsPDF: { 
                unit: 'in', 
                format: 'letter', 
                orientation: 'landscape' 
            }
        };
        
        // Add slight delay to ensure animations are removed
        setTimeout(() => {
            html2pdf().set(opt).from(certificate).save().then(() => {
                // Re-enable animations after download
                animatedElements.forEach(el => {
                    const originalClasses = el.getAttribute('data-original-classes') || '';
                    el.className = originalClasses;
                });
                certificate.classList.add('hover:scale-[1.01]', 'hover:shadow-2xl');
            });
        }, 300);
    });
</script>
{% endblock content %}